<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hospital Data Insights Dashboard</title>
   <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container-fluid">
            <div class="header-content">
                <h1>ğŸ¥ Hospital Data Insights Dashboard</h1>
                <div class="header-right">
                    <div class="api-status" id="apiStatus">
                        <span class="status-dot" id="statusDot"></span>
                        <span id="statusText">Connecting...</span>
                    </div>
                    <div class="last-updated" id="lastUpdated">Last updated: --</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav-tabs">
        <div class="container-fluid">
            <button class="nav-tab active" data-page="overview">ğŸ“Š Overview</button>
            <button class="nav-tab" data-page="opd">ğŸ¥ OPD Analytics</button>
            <button class="nav-tab" data-page="inpatient">ğŸ›ï¸ Inpatient & Ward</button>
            <button class="nav-tab" data-page="ai-risk">ğŸ¤– AI Risk Assessment</button>
        </div>
    </nav>

    <!-- Department Filter (Collapsible) -->
    <div class="filter-section" id="filterSection">
        <div class="container-fluid">
            <button class="filter-toggle" id="filterToggle">
                <span>ğŸ” Filter by Department</span>
                <span class="toggle-icon">â–¼</span>
            </button>
            <div class="filter-content" id="filterContent">
                <div class="filter-actions">
                    <button class="btn-filter" id="selectAllDepts">âœ“ All</button>
                    <button class="btn-filter" id="selectNoneDepts">âœ— None</button>
                    <span class="selection-count" id="selectionCount">10 selected</span>
                </div>
                <div class="filter-checkboxes" id="departmentFilters">
                    <!-- Populated by JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="container-fluid">
        
        <!-- OVERVIEW PAGE -->
        <div class="page-content active" id="page-overview">
            <!-- KPI Cards -->
            <section class="kpi-grid">
                <div class="kpi-card gradient-blue">
                    <div class="kpi-icon">ğŸ‘¥</div>
                    <div class="kpi-content">
                        <h3>Total Patients</h3>
                        <p class="kpi-value" id="totalPatients">--</p>
                        <span class="kpi-label">Registered in System</span>
                    </div>
                </div>

                <div class="kpi-card gradient-green">
                    <div class="kpi-icon">ğŸ¥</div>
                    <div class="kpi-content">
                        <h3>OPD Visits</h3>
                        <p class="kpi-value" id="totalVisits">--</p>
                        <span class="kpi-label">All Time</span>
                    </div>
                </div>

                <div class="kpi-card gradient-purple">
                    <div class="kpi-icon">ğŸ›ï¸</div>
                    <div class="kpi-content">
                        <h3>Admissions</h3>
                        <p class="kpi-value" id="totalAdmissions">--</p>
                        <span class="kpi-label">Inpatient</span>
                    </div>
                </div>

                <div class="kpi-card gradient-orange">
                    <div class="kpi-icon">â±ï¸</div>
                    <div class="kpi-content">
                        <h3>Avg Wait Time</h3>
                        <p class="kpi-value" id="avgWaitTime">--</p>
                        <span class="kpi-label">Minutes</span>
                    </div>
                </div>

                <div class="kpi-card gradient-red">
                    <div class="kpi-icon">ğŸ”„</div>
                    <div class="kpi-content">
                        <h3>Readmission Rate</h3>
                        <p class="kpi-value" id="readmissionRate">--</p>
                        <span class="kpi-label">30-Day</span>
                    </div>
                </div>

                <div class="kpi-card gradient-teal">
                    <div class="kpi-icon">ğŸ’°</div>
                    <div class="kpi-content">
                        <h3>Total Revenue</h3>
                        <p class="kpi-value" id="totalRevenue">--</p>
                        <span class="kpi-label">Billing Amount</span>
                    </div>
                </div>
            </section>

            <!-- Charts Row -->
            <section class="chart-grid">
                <div class="chart-card">
                    <h3>ğŸ“ˆ Monthly Visit Trends</h3>
                    <canvas id="trendsChart"></canvas>
                </div>

                <div class="chart-card">
                    <h3>ğŸ¢ Department Distribution</h3>
                    <canvas id="departmentChart"></canvas>
                </div>
            </section>
        </div>

        <!-- OPD ANALYTICS PAGE -->
        <div class="page-content" id="page-opd">
            <h2 class="page-title">ğŸ¥ Outpatient Department Analytics</h2>
            
            <div class="chart-grid">
                <div class="chart-card">
                    <h3>â±ï¸ Average Wait Time by Department</h3>
                    <canvas id="opdDeptWaitChart"></canvas>
                </div>

                <div class="chart-card">
                    <h3>ğŸ• Wait Time by Hour of Day</h3>
                    <canvas id="opdHourlyChart"></canvas>
                </div>

                <div class="chart-card">
                    <h3>ğŸ“… Visit Volume by Day of Week</h3>
                    <canvas id="opdDailyChart"></canvas>
                </div>

                <div class="chart-card">
                    <h3>ğŸ“Š Department Visit Volume</h3>
                    <canvas id="opdVolumeChart"></canvas>
                </div>
            </div>
        </div>

        <!-- INPATIENT ANALYTICS PAGE -->
        <div class="page-content" id="page-inpatient">
            <h2 class="page-title">ğŸ›ï¸ Inpatient & Ward Analytics</h2>
            
            <div class="chart-grid">
                <div class="chart-card">
                    <h3>ğŸ“Š Average Length of Stay by Ward</h3>
                    <canvas id="wardLOSChart"></canvas>
                </div>

                <div class="chart-card">
                    <h3>ğŸ”„ 30-Day Readmission Rate by Diagnosis</h3>
                    <canvas id="readmissionDiagChart"></canvas>
                </div>

                <div class="chart-card full-width">
                    <h3>ğŸ“ˆ Monthly Admission Trends</h3>
                    <canvas id="admissionTrendsChart"></canvas>
                </div>
            </div>
        </div>

        <!-- AI RISK ASSESSMENT PAGE -->
        <div class="page-content" id="page-ai-risk">
            <h2 class="page-title">ğŸ¤– AI-Powered Readmission Risk Assessment</h2>
            
            <!-- Individual Patient Assessment -->
            <section class="risk-assessment-section">
                <h3>ğŸ‘¤ Individual Patient Assessment</h3>
                
                <div class="patient-selector">
                    <label for="patientSelect">Select Patient:</label>
                    <select id="patientSelect" class="patient-dropdown">
                        <option value="">Loading patients...</option>
                    </select>
                    <button id="assessRiskBtn" class="btn-primary">Assess Risk</button>
                </div>

                <div id="patientRiskResult" class="patient-risk-result hidden">
                    <!-- Patient Profile -->
                    <div class="risk-card">
                        <h4>ğŸ“‹ Clinical Profile</h4>
                        <div class="profile-grid" id="patientProfile">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <!-- Risk Gauge -->
                    <div class="risk-card">
                        <h4>ğŸ¯ AI-Predicted Risk Assessment</h4>
                        <div class="risk-gauge-container">
                            <canvas id="riskGauge" width="300" height="150"></canvas>
                            <div class="risk-score-display">
                                <div class="risk-percentage" id="riskPercentage">--</div>
                                <div class="risk-category" id="riskCategory">Assessing...</div>
                            </div>
                        </div>
                        <div class="risk-comparison" id="riskComparison">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <!-- Clinical Recommendations -->
                    <div class="risk-card">
                        <h4>ğŸ“ Evidence-Based Clinical Recommendations</h4>
                        <div id="clinicalRecommendations" class="recommendations-list">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <!-- Risk Factors Analysis -->
                    <div class="risk-card">
                        <h4>âš ï¸ Detailed Risk Factor Analysis</h4>
                        <div id="riskFactorsList" class="risk-factors-grid">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Population Risk Stratification -->
            <section class="population-risk-section">
                <h3>ğŸ“Š Population-Level Risk Stratification</h3>
                
                <div class="risk-controls">
                    <div class="filter-group">
                        <label>Filter:</label>
                        <select id="riskFilter">
                            <option value="all">All Patients</option>
                            <option value="high">High Risk Only (â‰¥60%)</option>
                            <option value="medium-high">Med-High Risk (â‰¥35%)</option>
                            <option value="low">Low Risk (<35%)</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Sort by:</label>
                        <select id="riskSort">
                            <option value="risk-desc">Risk (High to Low)</option>
                            <option value="risk-asc">Risk (Low to High)</option>
                            <option value="age-desc">Age (Oldest First)</option>
                            <option value="age-asc">Age (Youngest First)</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Show:</label>
                        <select id="riskLimit">
                            <option value="20">20 patients</option>
                            <option value="50">50 patients</option>
                            <option value="100">100 patients</option>
                            <option value="200">200 patients</option>
                        </select>
                    </div>
                    <button id="exportRiskBtn" class="btn-secondary">ğŸ“¥ Export to CSV</button>
                </div>

                <!-- Population Statistics -->
                <div class="population-stats">
                    <div class="stat-badge high-risk">
                        <span class="stat-label">High Risk</span>
                        <span class="stat-value" id="highRiskCount">--</span>
                    </div>
                    <div class="stat-badge medium-risk">
                        <span class="stat-label">Medium Risk</span>
                        <span class="stat-value" id="mediumRiskCount">--</span>
                    </div>
                    <div class="stat-badge low-risk">
                        <span class="stat-label">Low Risk</span>
                        <span class="stat-value" id="lowRiskCount">--</span>
                    </div>
                    <div class="stat-badge total">
                        <span class="stat-label">Total Analyzed</span>
                        <span class="stat-value" id="totalAnalyzed">--</span>
                    </div>
                </div>

                <!-- High-Risk Patient Table -->
                <div class="table-container">
                    <table class="patient-table" id="highRiskTable">
                        <thead>
                            <tr>
                                <th>Patient ID</th>
                                <th>Risk %</th>
                                <th>Category</th>
                                <th>Age</th>
                                <th>BMI</th>
                                <th>Conditions</th>
                                <th>Visits</th>
                                <th>Admissions</th>
                                <th>Diabetes</th>
                                <th>Hypertension</th>
                            </tr>
                        </thead>
                        <tbody id="highRiskTableBody">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>

                <!-- Model Transparency Info -->
                <div class="model-info">
                    <p><strong>Model Information:</strong> Predictions use the best available trained model (TabPFN â†’ CatBoost â†’ Random Forest â†’ Logistic Regression). 
                    All recommendations are AI-assisted and should be reviewed by healthcare professionals.</p>
                </div>
            </section>
        </div>

    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container-fluid">
            <p>&copy; 2026 Hospital Data Insights Platform | Real-time Analytics & AI-Powered Clinical Decision Support</p>
        </div>
    </footer>

    <script src="dashboard.js"></script>
</body>
</html>
